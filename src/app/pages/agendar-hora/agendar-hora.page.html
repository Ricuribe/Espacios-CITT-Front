<ion-header class="main-header" [translucent]="true">
  <ion-toolbar class="main-toolbar">

    <!-- 
      AÑADIDO: Botón de Hamburguesa (para móvil)
    -->
    <ion-buttons slot="start" class="mobile-only-button">
      <ion-menu-button color="light"></ion-menu-button>
    </ion-buttons>

    <ion-img src="/assets/icon/logo_CITT.png" alt="Logo Duoc UC" class="logo"></ion-img>
    
    <!-- 
      MODIFICADO: Añadida la clase 'desktop-only-buttons'
    -->
    <ion-buttons slot="end" class="desktop-only-buttons">
      <ion-button fill="clear" color="light">Recursos</ion-button>
      <ion-button fill="clear" color="light">Memorias</ion-button>
      <ion-button class="btn-logout" fill="solid" color="light">Cerrar sesion</ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<!-- 
  AÑADIDO: Menú Lateral
-->
<ion-menu contentId="agendar-hora-content" type="overlay">
  <ion-header>
    <ion-toolbar color="primary">
      <ion-title>Menú</ion-title>
    </ion-toolbar>
  </ion-header>
  <ion-content>
    <ion-list>
      <ion-item button>
        <ion-label>Recursos</ion-label>
      </ion-item>
      <ion-item button>
        <ion-label>Memorias</ion-label>
      </ion-item>
      <ion-item button>
        <ion-label>Cerrar Sesión</ion-label>
      </ion-item>
    </ion-list>
  </ion-content>
</ion-menu>


<!-- 
  MODIFICADO: 'id' actualizado para coincidir con el contentId del menú
-->
<ion-content [fullscreen]="true" id="agendar-hora-content">
  <ion-grid class="main-content-grid">
    <ion-row>
      <ion-col>
        <ion-button fill="outline" color="medium" class="btn-volver" [routerLink]="['/inicio-usuario']" routerDirection="back">
          <ion-icon slot="start" name="chevron-back-outline"></ion-icon>
          Volver
        </ion-button>
      </ion-col>
    </ion-row>

    <ion-row>
      <ion-col class="ion-text-center">
        <h1>Selecciona el horario</h1>
      </ion-col>
    </ion-row>

    <ion-row class="ion-justify-content-center">
      <ion-col size="12" size-lg="8">
        
        <!-- Contenido del calendario (sin cambios) -->
        <div class="content-box">
          <ion-label>1. Elige una fecha</ion-label>
          <ion-datetime 
            presentation="date" 
            [showDefaultButtons]="false"
            [min]="todayISO"
            [max]="maxDateISO"
            [value]="selectedDate()"
            (ionChange)="handleDateChange($event)"
          ></ion-datetime>
        </div>

        <div class="content-box">
          <ion-label>2. Elige la duración</ion-label>
          <ion-range 
            [min]="30" 
            [max]="90" 
            [step]="30" 
            [snaps]="true" 
            [ticks]="true" 
            [value]="selectedDuration()"
            (ionChange)="handleDurationChange($event)"
          >
            <ion-label slot="start">30 min</ion-label>
            <ion-label slot="end">90 min</ion-label>
          </ion-range>
        </div>

        <div class="content-box">
          <ion-label>3. Elige una hora</ion-label>
          <ion-grid class="time-slot-grid">
            
            <div *ngIf="availableSlots().length > 0; else noSlotsMessage">
              <ion-row>
                <ion-col size="4" size-md="3" *ngFor="let slot of availableSlots()">
                  <ion-button 
                    [fill]="selectedSlot() === slot ? 'solid' : 'outline'" 
                    expand="block"
                    (click)="selectSlot(slot)">
                    {{ slot }}
                  </ion-button>
                </ion-col>
              </ion-row>
            </div>

            <ng-template #noSlotsMessage>
              <p class="no-slots-message">
                No hay horas disponibles para la fecha y duración seleccionadas.
              </p>
            </ng-template>

          </ion-grid>
        </div>
        
        <ion-button 
          expand="block" 
          size="large" 
          class="btn-primary"
          [disabled]="!selectedSlot()"
          (click)="confirmarReserva()">
          Confirmar Reserva
        </ion-button>

      </ion-col>
    </ion-row>

  </ion-grid>
</ion-content>

