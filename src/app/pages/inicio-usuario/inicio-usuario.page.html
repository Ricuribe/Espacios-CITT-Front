<!-- HEADER -->
<ion-header class="main-header" [translucent]="true">
  <ion-toolbar class="main-toolbar">
    
    <!-- IZQUIERDA: Botón Menú (SOLO MÓVIL) -->
    <ion-buttons slot="start" class="mobile-only-button desktop-hidden">
      <ion-menu-button color="light" menu="menu-inicio"></ion-menu-button>
    </ion-buttons>

    <!-- Logo -->
    <img src="/assets/icon/Gemvirt_logo.png" alt="Logo" class="logo">

    <!-- DERECHA: Info Usuario (Solo Desktop) -->
    <ion-buttons slot="end" class="desktop-user-info">
      <ion-chip class="user-chip">
        <ion-avatar>
          <img src="https://ionicframework.com/docs/img/demos/avatar.svg" alt="Avatar" />
        </ion-avatar>
        <ion-label>{{ userName() }}</ion-label>
      </ion-chip>

      <!-- NUEVO: Botón Cerrar Sesión -->
      <ion-button class="btn-logout-header" fill="solid" (click)="logout()">
        Cerrar Sesión
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<!-- MENÚ LATERAL -->
<ion-menu contentId="main-content-inicio" type="overlay" menuId="menu-inicio">
  <ion-header>
    <ion-toolbar>
      <ion-title>Menú</ion-title>
    </ion-toolbar>
  </ion-header>
  <ion-content>
    <ion-list lines="none">
      <ion-item button class="active-item">
        <ion-icon name="person-circle-outline" slot="start"></ion-icon>
        <ion-label>Mi Perfil</ion-label>
      </ion-item>
      <ion-item button [routerLink]="['/proyectos']">
        <ion-icon name="library-outline" slot="start"></ion-icon>
        <ion-label>Memorias</ion-label>
      </ion-item>
      <ion-item button [routerLink]="['/ver-eventos']">
        <ion-icon name="calendar-outline" slot="start"></ion-icon>
        <ion-label>Eventos</ion-label>
      </ion-item>
      <ion-item button (click)="logout()" class="logout-item">
        <ion-icon name="log-out-outline" slot="start"></ion-icon>
        <ion-label>Cerrar Sesión</ion-label>
      </ion-item>
    </ion-list>
  </ion-content>
</ion-menu>

<!-- CONTENIDO PRINCIPAL -->
<ion-content [fullscreen]="true" id="main-content-inicio" class="dashboard-content">
  
  <div class="page-container">

    <!-- BIENVENIDA -->
    <div class="welcome-section">
      <h1>Bienvenido, {{ userName() }}</h1>
      <p class="subtitle">¿Qué deseas gestionar hoy?</p>
    </div>

    <ion-grid class="dashboard-grid">
      
      <!-- VISTA ADMINISTRADOR (Solo Admin ve esto) -->
       <!--<ng-container *ngIf="isAdmin">
        <ion-row>
          <ion-col size="12"><h3 class="section-title">Panel de Administración</h3></ion-col>

          <ion-col size="12" size-sm="6" size-lg="3">
            <ion-card class="action-card" button>
              <div class="card-icon warning"><ion-icon name="document-text-outline"></ion-icon></div>
              <ion-card-header>
                <ion-card-title>Validar Memorias</ion-card-title>
                <ion-card-subtitle>Pendientes de revisión</ion-card-subtitle>
              </ion-card-header>
            </ion-card>
          </ion-col>
        </ion-row>
      </ng-container>-->

      <!-- VISTA DOCENTE / ADMIN (Gestión Académica) -->
      <ng-container *ngIf="canManageEvents">
        <ion-row>
          <ion-col size="12"><h3 class="section-title">Gestión Académica</h3></ion-col>

          <!-- IMPORTANTE: Solo Admin puede subir memorias -->
          <ng-container *ngIf="isAdmin">
            <ion-col size="12" size-sm="6" size-lg="4">
              <ion-card class="action-card" button [routerLink]="['/crear-memoria']">
                <div class="card-icon primary"><ion-icon name="cloud-upload-outline"></ion-icon></div>
                <ion-card-header>
                  <ion-card-title>Subir Nueva Memoria</ion-card-title>
                  <ion-card-subtitle>Publicar proyecto</ion-card-subtitle>
                </ion-card-header>
              </ion-card>
            </ion-col>
          </ng-container>

          <!-- Profesores y Admin pueden crear eventos -->
          <ion-col size="12" size-sm="6" size-lg="4">
            <ion-card class="action-card" button [routerLink]="['/evento-agendar']">
              <div class="card-icon primary"><ion-icon name="add-circle-outline"></ion-icon></div>
              <ion-card-header>
                <ion-card-title>Crear Evento</ion-card-title>
                <ion-card-subtitle>Talleres o charlas</ion-card-subtitle>
              </ion-card-header>
            </ion-card>
          </ion-col>
          
          <!-- Profesores y Admin pueden gestionar eventos -->
          <ion-col size="12" size-sm="6" size-lg="4">
            <ion-card class="action-card highlight-card" button [routerLink]="['/gestionar-eventos']">
              <div class="card-icon info"><ion-icon name="calendar-number-outline"></ion-icon></div>
              <ion-card-header>
                <ion-card-title>Gestionar Eventos</ion-card-title>
                <ion-card-subtitle>Administrar solicitudes</ion-card-subtitle>
              </ion-card-header>
            </ion-card>
          </ion-col>

        </ion-row>
      </ng-container>

      <!-- VISTA COMÚN (TODOS) -->
      <ion-row>
        <ion-col size="12"><h3 class="section-title">Mis Actividades</h3></ion-col>

        <ion-col size="12" size-sm="6" size-lg="4">
          <ion-card class="action-card" button [routerLink]="['/proyectos']">
            <div class="card-icon info"><ion-icon name="library-outline"></ion-icon></div>
            <ion-card-header>
              <ion-card-title>Repositorio de Memorias</ion-card-title>
              <ion-card-subtitle>Buscar y descargar</ion-card-subtitle>
            </ion-card-header>
          </ion-card>
        </ion-col>

        <ion-col size="12" size-sm="6" size-lg="4">
          <ion-card class="action-card" button [routerLink]="['/seleccion-espacio']">
            <div class="card-icon success"><ion-icon name="time-outline"></ion-icon></div>
            <ion-card-header>
              <ion-card-title>Reservar Espacio</ion-card-title>
              <ion-card-subtitle>Salas y mesas de estudio</ion-card-subtitle>
            </ion-card-header>
          </ion-card>
        </ion-col>

        <ion-col size="12" size-sm="6" size-lg="4">
          <ion-card class="action-card" button [routerLink]="['/ver-eventos']">
            <div class="card-icon purple"><ion-icon name="calendar-outline"></ion-icon></div>
            <ion-card-header>
              <ion-card-title>Próximos Eventos</ion-card-title>
              <ion-card-subtitle>Inscribirse a talleres</ion-card-subtitle>
            </ion-card-header>
          </ion-card>
        </ion-col>
      </ion-row>

    </ion-grid>

  </div>

  <app-footer></app-footer>
</ion-content>